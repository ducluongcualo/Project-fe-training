{"ast":null,"code":"var _dec, _class;\nimport axios from 'axios';\nimport { Service } from 'typedi';\nimport { API_HOST } from '../environment/environment';\nimport { USER_KEY } from './auth.service';\nimport { mockData } from './mock';\nimport { delay } from '../util/date-time.util';\n\n// import jwtDecode from 'jwt-decode';\nexport let HttpService = (_dec = Service(), _dec(_class = class HttpService {\n  constructor() {\n    this.token = void 0;\n    this.token = localStorage.getItem(USER_KEY);\n    axios.interceptors.response.use(response => {\n      // TODO: handle token;\n      return response;\n    });\n  }\n  get tokenInfo() {\n    return this.token;\n  }\n  async request(dto) {\n    const mockRequest = mockData.find(item => item.url === dto.url);\n    if (mockRequest) {\n      await delay(1);\n      const rs = mockRequest.handler(dto);\n      if (rs.data.access_token) {\n        this.token = rs.data.access_token;\n      }\n      return rs;\n    }\n    const response = await axios({\n      method: dto.method,\n      headers: {\n        Authorization: 'Bearer ' + this.token\n      },\n      baseURL: API_HOST,\n      url: dto.url,\n      data: dto.body,\n      params: dto.query\n    });\n    return response.data;\n  }\n}) || _class);","map":{"version":3,"names":["axios","Service","API_HOST","USER_KEY","mockData","delay","HttpService","constructor","token","localStorage","getItem","interceptors","response","use","tokenInfo","request","dto","mockRequest","find","item","url","rs","handler","data","access_token","method","headers","Authorization","baseURL","body","params","query"],"sources":["C:/reactjs/bnk_fe_training/base/src/services/http.service.ts"],"sourcesContent":["import axios from 'axios';\nimport { Service } from 'typedi';\nimport { API_HOST } from '../environment/environment';\nimport { DTO, ResponseDTO } from '../shared/dto/base.dto';\nimport { USER_KEY } from './auth.service';\nimport { mockData } from './mock';\nimport { delay } from '../util/date-time.util';\n\n// import jwtDecode from 'jwt-decode';\n@Service()\nexport class HttpService {\n    private token: string | null;\n\n    constructor() {\n        this.token = localStorage.getItem(USER_KEY);\n        axios.interceptors.response.use((response) => {\n            // TODO: handle token;\n            return response;\n        });\n    }\n\n    public get tokenInfo(): string | null {\n        return this.token;\n    }\n\n    public async request<T extends DTO>(dto: T): Promise<ResponseDTO<InstanceType<T['responseClass']>>> {\n        const mockRequest = mockData.find((item) => item.url === dto.url);\n        if (mockRequest) {\n            await delay(1);\n            const rs = mockRequest.handler(dto) as ResponseDTO<InstanceType<T['responseClass']>>;\n            if (rs.data.access_token) {\n                this.token = rs.data.access_token;\n            }\n            return rs;\n        }\n\n        const response = await axios({\n            method: dto.method,\n            headers: { Authorization: 'Bearer ' + this.token },\n            baseURL: API_HOST,\n            url: dto.url,\n            data: dto.body,\n            params: dto.query,\n        });\n        return response.data as ResponseDTO<InstanceType<T['responseClass']>>;\n    }\n}\n"],"mappings":";AAAA,OAAOA,KAAK,MAAM,OAAO;AACzB,SAASC,OAAO,QAAQ,QAAQ;AAChC,SAASC,QAAQ,QAAQ,4BAA4B;AAErD,SAASC,QAAQ,QAAQ,gBAAgB;AACzC,SAASC,QAAQ,QAAQ,QAAQ;AACjC,SAASC,KAAK,QAAQ,wBAAwB;;AAE9C;AACA,WACaC,WAAW,WADvBL,OAAO,EAAE,gBAAV,MACaK,WAAW,CAAC;EAGrBC,WAAW,GAAG;IAAA,KAFNC,KAAK;IAGT,IAAI,CAACA,KAAK,GAAGC,YAAY,CAACC,OAAO,CAACP,QAAQ,CAAC;IAC3CH,KAAK,CAACW,YAAY,CAACC,QAAQ,CAACC,GAAG,CAAED,QAAQ,IAAK;MAC1C;MACA,OAAOA,QAAQ;IACnB,CAAC,CAAC;EACN;EAEA,IAAWE,SAAS,GAAkB;IAClC,OAAO,IAAI,CAACN,KAAK;EACrB;EAEA,MAAaO,OAAO,CAAgBC,GAAM,EAA0D;IAChG,MAAMC,WAAW,GAAGb,QAAQ,CAACc,IAAI,CAAEC,IAAI,IAAKA,IAAI,CAACC,GAAG,KAAKJ,GAAG,CAACI,GAAG,CAAC;IACjE,IAAIH,WAAW,EAAE;MACb,MAAMZ,KAAK,CAAC,CAAC,CAAC;MACd,MAAMgB,EAAE,GAAGJ,WAAW,CAACK,OAAO,CAACN,GAAG,CAAkD;MACpF,IAAIK,EAAE,CAACE,IAAI,CAACC,YAAY,EAAE;QACtB,IAAI,CAAChB,KAAK,GAAGa,EAAE,CAACE,IAAI,CAACC,YAAY;MACrC;MACA,OAAOH,EAAE;IACb;IAEA,MAAMT,QAAQ,GAAG,MAAMZ,KAAK,CAAC;MACzByB,MAAM,EAAET,GAAG,CAACS,MAAM;MAClBC,OAAO,EAAE;QAAEC,aAAa,EAAE,SAAS,GAAG,IAAI,CAACnB;MAAM,CAAC;MAClDoB,OAAO,EAAE1B,QAAQ;MACjBkB,GAAG,EAAEJ,GAAG,CAACI,GAAG;MACZG,IAAI,EAAEP,GAAG,CAACa,IAAI;MACdC,MAAM,EAAEd,GAAG,CAACe;IAChB,CAAC,CAAC;IACF,OAAOnB,QAAQ,CAACW,IAAI;EACxB;AACJ,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}